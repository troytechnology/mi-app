function renderTable(data) {
  excelView.style.display = "block";

  // Destruir DataTable si ya existe
  if ($.fn.DataTable.isDataTable("#excelTable")) {
    $("#excelTable").DataTable().destroy();
  }
  excelTable.innerHTML = "";

  // Asegurar que todas las filas tengan la misma cantidad de columnas
  const colCount = data[0].length;
  const normalizedData = data.map(row => {
    const newRow = [...row];
    while (newRow.length < colCount) newRow.push(""); // rellenar vacÃ­os
    if (newRow.length > colCount) newRow.length = colCount; // recortar extras
    return newRow;
  });

  // Encabezados
  if (normalizedData.length > 0) {
    const thead = document.createElement("thead");
    const headerRow = document.createElement("tr");
    normalizedData[0].forEach(header => {
      const th = document.createElement("th");
      th.textContent = header;
      headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);
    excelTable.appendChild(thead);
  }

  // Filas
  const tbody = document.createElement("tbody");
  normalizedData.slice(1).forEach(row => {
    const tr = document.createElement("tr");
    row.forEach(cell => {
      const td = document.createElement("td");
      td.textContent = cell ?? "";
      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });
  excelTable.appendChild(tbody);

  // Inicializar DataTables con filtros
  $("#excelTable").DataTable({
    paging: true,
    searching: true,
    ordering: true,
    pageLength: 10,
    language: {
      url: "//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"
    }
  });
}






